<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        :root {
            --vh: 1vh;
        }
        html, body {
            height: calc(var(--vh, 1vh) * 100);
        }
    </style>
</head>
<body>
    
    <button id="back-button" onclick="goBack()" style="display: none;">
        <img src="/static/back.svg" alt="–ù–∞–∑–∞–¥">
    </button>
    <div class="header">
        <img src="/static/logo22.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo">
    </div>

    <div class="menu-vertical" id="content">
        <button onclick="showRegions()">–ê–¥—Ä–µ—Å–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤</button>
        <button onclick="showSection('catalog')">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</button>
        <button onclick="showSection('review')">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
        <button onclick="showSection('contacts')">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
        <button onclick="showSection('jobs')">–í–∞–∫–∞–Ω—Å–∏–∏</button>
        <button onclick="showSection('promotions')">–ê–∫—Ü–∏–∏</button>
    </div>

    <div class="footer-buttons">
        <div id="home-button" onclick="goHome()">
            <img src="/static/home.svg" alt="–î–æ–º–æ–π">
        </div>
        <div id="login-button">
            <img src="/static/login.svg" alt="–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è">
        </div>
    </div>

    <div class="cart-button-container">
        <button onclick="openCart()" class="cart-button">
            <img src="/static/shop.svg" alt="–ö–æ—Ä–∑–∏–Ω–∞">
        </button>
    </div>
    <!-- –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç HTML –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º </body> -->
    <div id="personal-cabinet" style="display: none;">
        <div class="user-header">
            <div class="user-avatar" id="user-avatar">
                <img src="" alt="–ê–≤–∞—Ç–∞—Ä" id="user-avatar-img">
            </div>
        </div>
    
        <div class="user-data">
            <div class="data-row">
                <span class="data-label">–Æ–∑–µ—Ä–Ω–µ–π–º:</span>
                <span class="data-value" id="user-username"></span>
            </div>
            <div class="data-row">
                <span class="data-label">–ò–º—è:</span>
                <span class="data-value" id="user-name"></span>
            </div>
            <div class="data-row">
                <span class="data-label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                <span class="data-value" id="user-phone"></span>
            </div>
        </div>
    
        <button id="edit-profile-btn" class="edit-btn">‚úèÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
    </div>

    <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div id="edit-form" style="display: none;">
        <div class="form-header">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h3>
        </div>
    
        <div class="form-group">
            <label for="edit-name">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è</label>
            <input type="text" id="edit-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
        </div>
    
        <div class="form-group">
            <label for="edit-phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="tel" id="edit-phone" placeholder="+375 XX XXX-XX-XX">
        </div>
    
        <button id="save-profile-btn" class="save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
    <div id="thank-you-message" style="display: none;">
        <div class="thank-you-content">
            <h3>–°–ø–∞—Å–∏–±–æ!</h3>
            <p>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.</p>
            <button id="return-to-cabinet" class="return-btn">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</button>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const setFullHeight = () => {
                document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
            };
            window.addEventListener('resize', setFullHeight);
            window.addEventListener('load', setFullHeight);
            setFullHeight();

            document.body.style.overflow = 'hidden';
            document.body.style.userSelect = 'none';
            document.addEventListener('dblclick', (e) => e.preventDefault());
            document.getElementById('back-button').addEventListener('click', goBack);
            document.getElementById('login-button').addEventListener('click', function(e) {
                console.log('Login button clicked', e);
                auth();
            });
            if (window.Telegram?.WebApp) {
                Telegram.WebApp.expand();
                Telegram.WebApp.ready();
            } else {
                document.body.innerHTML = "–û—à–∏–±–∫–∞: –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram!";
                return;
            }

            let currentState = "home";
            let currentRegion = null;
            let currentCity = null;
            showHome();
            const contentDiv = document.getElementById('content');

            contentDiv.addEventListener('click', (e) => {
                if (e.target.closest('#back-button')) {
                    goBack();
                    return;
                }
                const btn = e.target.closest('button');
                if (!btn) return;

                const action = btn.dataset.action;
                if (action) {
                    console.log("–ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞:", action);
        
                    if (action === 'regions') showRegions();
                    else if (action.startsWith('section:')) showSection(action.split(':')[1]);
                    else if (action.startsWith('city:')) showCities(action.split(':')[1]);
                    else if (action.startsWith('store:')) {
                        const [_, city, region] = action.split(':');
                        showStores(city, region);
                    } else if (action.startsWith('detail:')) {
                        showStoreDetails(action.split(':')[1]);
                    } else if (action === 'goHome') {
                        goHome();
                    }
                }

                const starEl = e.target.closest('.star');
                if (starEl && starEl.dataset.stars) {
                    const count = parseInt(starEl.dataset.stars);
                    selectStars(count);
                }


                const submitBtn = e.target.closest('#submit-review');
                if (submitBtn) {
                    submitReview();
                }
            });

            async function loadData(url) {
                try {
                    const response = await fetch(`/api/${url}`);
                    if (!response.ok) throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö");
                    return await response.json();
                } catch (error) {
                    console.error(error);
                    return null;
                }
            }

            function showContent(content, showBack = true, onRendered = null) {
                const contentDiv = document.getElementById('content');
                const backButton = document.getElementById('back-button');

                if (backButton) {
                    backButton.style.display = showBack ? 'block' : 'none';
                } else {
                    console.warn('‚ö†Ô∏è #back-button –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ DOM');
                }

                contentDiv.classList.add('hidden');
                setTimeout(() => {
                    contentDiv.innerHTML = content;
                    setTimeout(() => {
                        contentDiv.classList.remove('hidden');
                        if (typeof onRendered === 'function') onRendered();
                    }, 50);
                }, 300);
            }



            function showHome() {
                currentState = "home";
                showContent(`
                    <button data-action="regions">–ê–¥—Ä–µ—Å–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤</button>
                    <button data-action="section:catalog">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</button>
                    <button data-action="section:review">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                    <button data-action="section:contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
                    <button data-action="section:jobs">–í–∞–∫–∞–Ω—Å–∏–∏</button>
                    <button data-action="section:promotions">–ê–∫—Ü–∏–∏</button>
                `, false);
            }

            function goBack() {
                console.log("üîô goBack –≤—ã–∑–≤–∞–Ω. currentState =", currentState);
                if (currentState === "regions") {
                    showHome();
                } else if (currentState === "cities") {
                    showRegions();
                } else if (currentState === "stores") {
                    showCities(currentRegion);
                } else if (currentState === "storeDetails") {
                    showStores(currentCity, currentRegion);
                } else if (["review", "contacts", "jobs", "promotions"].includes(currentState)) {
                    showHome();
                } else {
                    console.warn("‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:", currentState);
                    showHome();
                }
            }




            async function showRegions() {
                currentState = "regions";
                const regions = await loadData('regions');
                if (regions) {
                    const buttons = regions.map(region =>
                        `<button data-action="city:${region}">${region}</button>`).join('');
                    showContent(`<h3>–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å:</h3>${buttons}`, true);
                }
            }

            async function showCities(region) {
                currentState = "cities";
                currentRegion = region;
                const cities = await loadData(`cities/${region}`);
                if (cities) {
                    const buttons = cities.map(city =>
                        `<button data-action="store:${city}:${region}">${city}</button>`).join('');
                    showContent(`<h3>–ì–æ—Ä–æ–¥–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ "${region}":</h3>${buttons}`, true);
                }
            }

            async function showStores(city, region) {
                currentState = "stores";
                currentCity = city;
                const stores = await loadData(`stores/${region}/${city}`);
                if (stores) {
                    const buttons = stores.map(store =>
                        `<button data-action="detail:${store.name}">${store.name}</button>`).join('');
                    showContent(`<h3>–ú–∞–≥–∞–∑–∏–Ω—ã –≤ –≥–æ—Ä–æ–¥–µ "${city}":</h3>${buttons}`, true);
                }
            }

            async function showStoreDetails(storeName) {
                currentState = "storeDetails";
                const stores = await loadData(`stores/${currentRegion}/${currentCity}`);
                const store = stores.find(s => s.name === storeName);
                if (store) {
                    showContent(`
                        <h3>${store.name}</h3>
                        <p><strong>–ê–¥—Ä–µ—Å:</strong> ${store.address}</p>
                        <p><strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> ${store.hours.replace(/\n/g, '<br>')}</p>
                        <button onclick='window.open("${store.map_url}", "_blank")'>–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
                    `, true);
                }
            }

            function showSection(section) {
                if (section === 'contacts') {
                    currentState = "contacts";
                    showContent(`
                        <h3>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏</h3>
                        <button onclick="copyPhoneNumber()">–ü–æ–∑–≤–æ–Ω–∏—Ç—å: +375 29 225-13-34</button>
                        <button onclick="window.open('https://www.instagram.com/nekuri.by/', '_blank')">Instagram</button>
                        <button onclick="window.open('https://t.me/nekuri_by', '_blank')">Telegram –∫–∞–Ω–∞–ª</button>
                        <button onclick="window.open('https://t.me/nekuri_by_brest', '_blank')">Telegram —á–∞—Ç</button>
                        <button onclick="window.open('https://vk.com/nekuribrest', '_blank')">–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</button>
                        <button onclick="window.open('https://www.tiktok.com/@nekuri.by', '_blank')">TikTok</button>
                    `, true);
                } else if (section === 'review') {
                    checkReviewCooldown();
                } else if (section === 'jobs') {
                    currentState = "jobs";
                    showContent(`
                        <div class="vacancy-block">
                            <h3>–ü—Ä–æ–¥–∞–≤–µ—Ü-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</h3>
                            <p>–≠—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏—è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤–ª—é–±–ª–µ–Ω –≤ –Ω–∞—à –ø—Ä–æ–¥—É–∫—Ç, –∫—Ç–æ –ª—é–±–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –∏ —Ö–æ—á–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–º –±–∏–∑–Ω–µ—Å–µ.</p>
                            <h4>–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:</h4>
                            <ul>
                                <li>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã (–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ).</li>
                                <li>–ó–∞–¥–∞–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ª—É—á—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Å–µ—Ç–∏.</li>
                                <li>–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞, –∫–æ–º–ø–ª–µ–∫—Ç–Ω–æ—Å—Ç–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏, –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞).</li>
                                <li>–†–∞—Å—á–µ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –Ω–∞ –∫–∞—Å—Å–µ.</li>
                                <li>–í—ã–∫–ª–∞–¥–∫–∞ —Ç–æ–≤–∞—Ä–∞, —Ü–µ–Ω–Ω–∏–∫–∏, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞.</li>
                                <li>–£—á–∞—Å—Ç–∏–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è—Ö.</li>
                                <li>–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —á–∏—Å—Ç–æ—Ç—ã –∏ –ø–æ—Ä—è–¥–∫–∞ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º –∑–∞–ª–µ.</li>
                                <li>–°–æ–±–ª—é–¥–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤.</li>
                            </ul>
                            <h4>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</h4>
                            <ul>
                                <li>–ì—Ä–∞–º–æ—Ç–Ω–∞—è —Ä–µ—á—å, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.</li>
                                <li>–ö–∞–∫ –ø–ª—é—Å ‚Äî –∑–Ω–∞–Ω–∏–µ –∫–∞—Å—Å–æ–≤–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, —É–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–µ–Ω–µ–∂–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏.</li>
                                <li>–£–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ, –∂–µ–ª–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å, –∫–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–∞–ª–∏—á–∏–µ –ª–∏–¥–µ—Ä—Å–∫–∏—Ö –∫–∞—á–µ—Å—Ç–≤.</li>
                            </ul>
                            <p>–ú—ã —Ä–∞–¥—ã –ø—Ä–∏–Ω—è—Ç—å –≤ –Ω–∞—à –¥—Ä—É–∂–Ω—ã–π, –º–æ–ª–æ–¥–æ–π –∫–æ–ª–ª–µ–∫—Ç–∏–≤ –∫–æ–ª–ª–µ–≥, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –≤–ø–µ—Ä–µ–¥!</p>
                            <h4>–£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã:</h4>
                            <ul>
                                <li>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ.</li>
                                <li>–†–∞–±–æ—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–º –∫–æ–ª–ª–µ–∫—Ç–∏–≤–µ.</li>
                                <li>–û–ø–ª–∞—Ç–∞ —Ç—Ä—É–¥–∞, –∑–∞–≤–∏—Å—è—â–∞—è –æ—Ç –í–∞—à–µ–π —Ä–∞–±–æ—Ç—ã.</li>
                            </ul>
                            <p>–ï—Å–ª–∏ –≤—Å—ë –∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ –≤—ã—à–µ –í–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —Ç–æ –º—ã –∂–¥—ë–º –í–∞—à–∏—Ö –æ—Ç–∫–ª–∏–∫–æ–≤!</p>
                            <h3 style="margin-top: 20px;">–ê–Ω–∫–µ—Ç–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</h3>
                            <p>–ü–æ—Å–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è —Ä–µ–∑—é–º–µ —Å –í–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø–æ–¥–±–æ—Ä—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞.</p>
                            <div class="form-container">
                                <iframe src="https://forms.yandex.ru/u/68079eb7d046880cc459b018/?iframe=1"
                                    frameborder="0"
                                    name="ya-form-68079eb7d046880cc459b018"
                                    width="100%"
                                    height="480" style="border: none;"></iframe>
                            </div>

                        </div>
                    `, true);
                
                } else if (section === 'promotions') {
                    currentState = "promotions";
                    showPromotions();
                } else {
                    alert(`–†–∞–∑–¥–µ–ª "${section}" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!`);
                }
            }


            function checkReviewCooldown() {
                const lastTime = localStorage.getItem('lastReviewTime');
                if (lastTime) {
                    const now = Date.now();
                    const diff = now - parseInt(lastTime);
                    const remaining = 24 * 60 * 60 * 1000 - diff;
                    if (remaining > 0) {
                        const hours = Math.floor(remaining / (60 * 60 * 1000));
                        const minutes = Math.floor((remaining % (60 * 60 * 1000)) / (60 * 1000));
                        showContent(`
                            <p>‚ö†Ô∏è –í—ã —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –æ—Ç–∑—ã–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞.</p>
                            <p>‚åõÔ∏è –î–æ —Å–ª–µ–¥—É—é—â–µ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –æ—Å—Ç–∞–ª–æ—Å—å:<br><strong>${hours} —á ${minutes} –º–∏–Ω</strong>.</p>
                        `, true);
                        return;
                    }
                }
                showReviewForm();
            }

            function showReviewForm() {
                currentState = "review";

                showContent(`
                    <h3>–û—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</h3>
                    <div id="stars" style="font-size: 32px; margin-bottom: 10px;">
                        ${[1, 2, 3, 4, 5].map(i => `
                            <span class="star" data-stars="${i}" id="star${i}">‚≠ê</span>
                        `).join('')}
                    </div>
                    <textarea id="reviewText" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–∑—ã–≤..." rows="5"
                              style="width: 90%; margin-top: 20px; border-radius: 10px; padding: 10px; border: 1px solid #ccc;"></textarea>
                    <button id="submit-review" style="margin-top: 15px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    <div id="toast" class="toast"></div>
                `, true, () => {
                    // ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–≤—ë–∑–¥
                    const stars = document.querySelectorAll('.star');
                    stars.forEach(star => {
                        star.addEventListener('click', () => {
                            const count = parseInt(star.dataset.stars);
                            window.reviewStars = count;

                            stars.forEach((el, index) => {
                                if (index < count) {
                                    el.textContent = 'üåü';
                                    el.classList.add('pop');
                                } else {
                                    el.textContent = '‚≠ê';
                                    el.classList.remove('pop');
                                }
                            });
                        });
                    });

                    // ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
                    const submitBtn = document.getElementById('submit-review');
                    submitBtn.addEventListener('click', () => {
                        const text = document.getElementById('reviewText').value.trim();

                        if (!window.reviewStars || window.reviewStars === 0) {
                            showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ—Ü–µ–Ω–∫—É");
                            return;
                        }

                        if (text.length < 3) {
                            showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤");
                            return;
                        }

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
                        sendReviewToTelegram(window.reviewStars, text);
                        localStorage.setItem('lastReviewTime', Date.now().toString());

                        showContent(`
                            <p>üôè –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –æ—Ç–∑—ã–≤!</p>
                            <p>–ù–∞–º –≤–∞–∂–Ω–æ –≤–∞—à–µ –º–Ω–µ–Ω–∏–µ üòä</p>
                            <button data-action="goHome">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                        `, true);
                    });

                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                    window.reviewStars = 0;
                });
            }





            function selectStars(count) {
                window.reviewStars = count;
                for (let i = 1; i <= 5; i++) {
                    const el = document.getElementById(`star${i}`);
                    if (i <= count) {
                        el.textContent = 'üåü';
                        el.classList.add('pop');
                    } else {
                        el.textContent = '‚≠ê';
                        el.classList.remove('pop');
                    }
                }
            }

            function submitReview() {
                const text = document.getElementById('reviewText').value.trim();
                if (window.reviewStars === 0) {
                showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ—Ü–µ–Ω–∫—É");
                return;
                }

                if (text.length < 3) {
                    showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤");
                    return;
                }
                sendReviewToTelegram(reviewStars, text);
                localStorage.setItem('lastReviewTime', Date.now().toString());
                showContent(`
                    <p>üôè –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –æ—Ç–∑—ã–≤!</p>
                    <p>–ù–∞–º –≤–∞–∂–Ω–æ –≤–∞—à–µ –º–Ω–µ–Ω–∏–µ üòä</p>
                    <button data-action="goHome">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                `, true);
            }

            function sendReviewToTelegram(stars, text) {
                const username = Telegram.WebApp.initDataUnsafe?.user?.username || '–ë–µ–∑ username';
                const message = `‚≠ê –û—Ü–µ–Ω–∫–∞: ${stars}/5\n‚úçÔ∏è –û—Ç–∑—ã–≤: ${text}\nüë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @${username}`;
                fetch('https://api.telegram.org/bot7210822073:AAFM7PAj5D9PEJrvwArF8rSaU4FqsyT-3ns/sendMessage', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: '568416622',
                        text: message
                    })
                });
            }

            function showToast(message, duration = 2000) {
                let toast = document.getElementById('toast');
                if (!toast) {
                    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
                    toast = document.createElement('div');
                    toast.id = 'toast';
                    toast.className = 'toast';
                    toast.style.cssText = `
                        position: fixed;
                        bottom: 20px;
                        left: 50%;
                        transform: translateX(-50%);
                        background: rgba(0,0,0,0.7);
                        color: white;
                        padding: 12px 24px;
                        border-radius: 4px;
                        z-index: 1000;
                        opacity: 0;
                        transition: opacity 0.3s;
                    `;
                    document.body.appendChild(toast);
                }

                toast.textContent = message;
                toast.style.opacity = 1;

                setTimeout(() => {
                    toast.style.opacity = 0;
                }, duration);
            }

            async function showPromotions() {
                showContent(`<p>–ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ü–∏–π...</p>`, true);
    
                try {
                    // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ –≤–∞—à API
                    const response = await fetch('https://nekuri.by/api/news-feed.php');
        
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
        
                    const promotions = await response.json();
        
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
                    if (!Array.isArray(promotions)) {
                        throw new Error("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö");
                    }
        
                    // –ö—ç—à–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                    localStorage.setItem('cachedPromotions', JSON.stringify(promotions));
                    localStorage.setItem('promotionsCacheTime', Date.now().toString());
        
                    renderPromotions(promotions);
                } catch (error) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ü–∏–π:", error);
        
                    // –ü—Ä–æ–±—É–µ–º –ø–æ–∫–∞–∑–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    const cached = localStorage.getItem('cachedPromotions');
                    if (cached) {
                        renderPromotions(JSON.parse(cached));
                        showToast("–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ");
                    } else {
                        showContent(`
                            <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–∫—Ü–∏–∏</p>
                            <button onclick="showPromotions()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                            <button data-action="goHome">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                        `, true);
                    }
                }
            }

            function renderPromotions(promotions) {
                if (!promotions || !Array.isArray(promotions)) {
                    showContent(`<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∞–∫—Ü–∏—è—Ö</p><button data-action="goHome">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>`, true);
                    return;
                }

                const promotionsHTML = promotions.map(promo => {
                    // –û—á–∏—â–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
                    const cleanDescription = promo.description 
                        ? promo.description.replace(/\n\t+/g, ' ').trim().substring(0, 100) + '...'
                        : '';
            
                    return `
                        <div class="promotion-item" onclick="window.open('${promo.link}', '_blank')">
                            <img src="${promo.image}" alt="${promo.title}" 
                                 onerror="this.onerror=null;this.src='/static/no-image.png'">
                            <h4>${promo.title}</h4>
                            ${cleanDescription ? `<p>${cleanDescription}</p>` : ''}
                        </div>
                    `;
                }).join('');

                showContent(`
                    <h3>–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∞–∫—Ü–∏–∏</h3>
                    ${promotionsHTML.length ? promotionsHTML : '<p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π</p>'}
                    <button data-action="goHome" style="margin-top: 20px;">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                `, true);
            }
            function goHome() {
                showHome();
                console.log('Home screen shown');
            }

            // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            async function auth() {
                console.log('Auth function called');
                try {
                    if (!window.Telegram?.WebApp) {
                        showToast("–û—Ç–∫—Ä–æ–π—Ç–µ –≤ Telegram");
                        return;
                    }

                    const tg = Telegram.WebApp;
                    const user = tg.initDataUnsafe?.user;
                    console.log('User data:', user);

                    if (!user) {
                        Telegram.WebApp.openTelegramLink(`https://t.me/Shop_NEKURIBY_bot?start=auth_${Date.now()}`);
                        return;
                    }

                    const userData = {
                        id: user.id,
                        username: user.username || `id${user.id}`,
                        first_name: user.first_name || '',
                        phone: user.phone_number || '',
                        photo_url: user.photo_url || '/static/user-avatar.png'
                    };
                    const checkUser = await fetch(`/api/get-user?username=${encodeURIComponent(userData.username)}`);
                    const userExists = await checkUser.json();

                    if (!userExists.exists) {
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç
                        await fetch('/api/save-user', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({
                                username: userData.username,
                                name: userData.first_name,
                                phone: userData.phone
                            })
                        });
                    }
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
                    showWelcomeMessage(userData);

                    try {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        const response = await fetch(`/api/get-user?username=${encodeURIComponent(userData.username)}`);
                        const result = await response.json();

                        if (result.status === 'error') {
                            throw new Error(result.message);
                        }

                        if (!result.exists) {
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                            const saveResponse = await fetch('/api/save-user', {
                                method: 'POST',
                                headers: {'Content-Type': 'application/json'},
                                body: JSON.stringify({
                                    username: userData.username,
                                    name: userData.first_name,
                                    phone: userData.phone
                                })
                            });
                    
                            const saveResult = await saveResponse.json();
                    
                            if (saveResult.status !== 'success') {
                                throw new Error(saveResult.message || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                            }
                        }

                        // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                        setTimeout(() => {
                            showPersonalCabinet(userData);
                        }, 2000);

                    } catch (error) {
                        console.error('Auth error:', error);
                        // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–±–∏–Ω–µ—Ç
                        setTimeout(() => {
                            showPersonalCabinet(userData);
                        }, 2000);
                    }
                } catch (error) {
                    console.error('Global auth error:', error);
                    showToast("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏");
                }
            }

            // –ü–æ–∫–∞–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
            function showPersonalCabinet(user) {
                // –£–¥–∞–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å
                const welcomeScreen = document.getElementById('welcome-screen');
                if (welcomeScreen) welcomeScreen.remove();

                // –°–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                document.getElementById('content').style.display = 'none';
                document.getElementById('thank-you-message').style.display = 'none';
                document.getElementById('edit-form').style.display = 'none';

                // –ó–∞–ø–æ–ª–Ω—è–µ–º –∞–≤–∞—Ç–∞—Ä
                const avatarImg = document.getElementById('user-avatar-img');
                if (avatarImg) {
                    avatarImg.src = user.photo_url || '/static/user-avatar.png';
                    avatarImg.alt = user.first_name || '–ê–≤–∞—Ç–∞—Ä';
                }

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
                fetch(`/api/get-user?username=${encodeURIComponent(user.username)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'success') {
                            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                            document.getElementById('user-username').textContent = `@${data.user.Username || user.username}`;
                            document.getElementById('user-name').textContent = data.user.Name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                            document.getElementById('user-phone').textContent = data.user.Phone || '–ù–µ —É–∫–∞–∑–∞–Ω';
                
                            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                            user.first_name = data.user.Name || user.first_name;
                            user.phone = data.user.Phone || user.phone;
                            localStorage.setItem('currentUser', JSON.stringify(user));
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ fallback
                        document.getElementById('user-username').textContent = `@${user.username}`;
                        document.getElementById('user-name').textContent = user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                        document.getElementById('user-phone').textContent = user.phone || '–ù–µ —É–∫–∞–∑–∞–Ω';
                    });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                document.getElementById('personal-cabinet').style.display = 'block';

                // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                document.getElementById('edit-profile-btn').onclick = () => showEditForm(user);
            }
            // –ü–æ–∫–∞–∑ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            function showWelcomeMessage(user) {
                // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                document.getElementById('content').style.display = 'none';
        
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
                const welcomeDiv = document.createElement('div');
                welcomeDiv.id = 'welcome-screen';
                welcomeDiv.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: white;
                    z-index: 1000;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    text-align: center;
                    padding: 20px;
                `;
        
                welcomeDiv.innerHTML = `
                    <div class="welcome-avatar" style="
                        width: 100px;
                        height: 100px;
                        border-radius: 50%;
                        overflow: hidden;
                        margin-bottom: 20px;
                    ">
                        <img src="${user.photo_url}" alt="–ê–≤–∞—Ç–∞—Ä" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}!</h2>
                    <p>–°–µ–π—á–∞—Å –º—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–º –≤–∞—Å –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç...</p>
                `;
        
                document.body.appendChild(welcomeDiv);
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            function showEditForm(user) {
                document.getElementById('personal-cabinet').style.display = 'none';
        
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                document.getElementById('edit-name').value = user.first_name || '';
                document.getElementById('edit-phone').value = user.phone || '';
        
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('edit-form').style.display = 'block';
        
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                document.getElementById('save-profile-btn').onclick = function() {
                    saveProfile(user.username);
                };
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
            async function saveProfile(username) {
                const name = document.getElementById('edit-name').value.trim();
                const phone = document.getElementById('edit-phone').value.trim();

                try {
                    const response = await fetch('/api/save-user', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            username: username,
                            name: name,
                            phone: phone
                        })
                    });

                    const result = await response.json();
        
                    if (result.status !== 'success') {
                        throw new Error(result.message || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                    }

                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                    const user = JSON.parse(localStorage.getItem('currentUser')) || {};
                    user.first_name = name;
                    user.phone = phone;
                    localStorage.setItem('currentUser', JSON.stringify(user));

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                    showThankYouMessage();

                    // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                    showPersonalCabinet(user);
        
                } catch (error) {
                    console.error('Save error:', error);
                    showToast("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: " + error.message);
                }
            }
            // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
            function updateUserData(user) {
                document.getElementById('user-name').textContent = user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                document.getElementById('user-phone').textContent = user.phone || '–ù–µ —É–∫–∞–∑–∞–Ω';
            }

            // –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            function showThankYouMessage() {
                document.getElementById('edit-form').style.display = 'none';
    
                const thankYouDiv = document.getElementById('thank-you-message');
                thankYouDiv.innerHTML = `
                    <div class="thank-you-content">
                        <h3>–°–ø–∞—Å–∏–±–æ!</h3>
                        <p>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã</p>
                    </div>
                `;
                thankYouDiv.style.display = 'flex';
    
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    thankYouDiv.style.display = 'none';
                    const user = JSON.parse(localStorage.getItem('currentUser')) || {};
                    document.getElementById('personal-cabinet').style.display = 'block';
                }, 2000);
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞
            document.getElementById('return-to-cabinet')?.addEventListener('click', function() {
                const user = JSON.parse(localStorage.getItem('currentUser')) || {};
                document.getElementById('thank-you-message').style.display = 'none';
                showPersonalCabinet(user);
            });
            function openCart() {
                alert("–§—É–Ω–∫—Ü–∏—è –∫–æ—Ä–∑–∏–Ω—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!");
            }

            // –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
            // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            window.showHome = showHome;
            window.goHome = goHome;
            window.auth = auth; // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
            window.openCart = openCart;
            window.goBack = goBack;
            window.showSection = showSection;

            // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤
            window.showRegions = showRegions;
            window.showCities = showCities;
            window.showStores = showStores;
            window.showStoreDetails = showStoreDetails;

            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            window.copyPhoneNumber = function() {
                const phone = "+375 29 225-13-34";
                navigator.clipboard.writeText(phone)
                    .then(() => showToast("–ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!"))
                    .catch(() => showToast("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä"));
            };
            
        });
    </script>
<div id="toast" class="toast" style="
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 12px 24px;
    border-radius: 4px;
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s;
"></div>
</body>
</html>
