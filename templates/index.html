<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Permissions-Policy" content="clipboard-write">
    <meta http-equiv="Permissions-Policy" content="clipboard-write, vibration">
    <title>–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/footer.css">
    <link rel="stylesheet" href="/static/css/user.css">
    <style>
        :root {
            --vh: 1vh;
        }
        html, body {
            height: calc(var(--vh, 1vh) * 100);
        }
    </style>
</head>
<body>
    <body style="overflow-x: hidden;">
    <button id="back-button" onclick="goBack()" style="display: none;">
        <img src="/static/back.svg" alt="–ù–∞–∑–∞–¥">
    </button>
    <div class="header">
        <img src="/static/logo22.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo">
    </div>

    <div class="menu-vertical" id="content">
        <button onclick="showRegions()">–ê–¥—Ä–µ—Å–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤</button>
        <button onclick="showSection('review')">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
        <button onclick="showSection('contacts')">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
        <button onclick="showSection('jobs')">–í–∞–∫–∞–Ω—Å–∏–∏</button>
    </div>
    <div class="footer-nav">
      <div class="footer-item" id="home-button" data-section="home">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="512" height="512">
        <path d="M0 0 C3.61395175 2.97681249 7.27964195 5.88001568 10.97265625 8.7578125 C16.02153897 12.69921231 21.01023855 16.70813263 25.97265625 20.7578125 C31.52183684 25.28535322 37.11181262 29.75297112 42.75390625 34.1640625 C47.65582639 37.99889798 52.51524943 41.88503591 57.36962891 45.77978516 C61.52850264 49.11269172 65.71149826 52.41272535 69.91015625 55.6953125 C75.66883553 60.20040173 81.34693935 64.79897395 87.01147461 69.42163086 C91.86022646 73.37188074 96.75979476 77.25054746 101.69018555 81.09814453 C106.78553088 85.0850565 111.790079 89.17858891 116.79418945 93.27905273 C120.96017962 96.6744725 125.19139617 99.96104584 129.48901367 103.18798828 C150.56628694 119.03445731 166.88266604 136.16319868 171.49823475 163.35405731 C172.02894649 167.72099409 172.11461088 171.95789073 172.10636902 176.35070801 C172.10863458 177.24448701 172.11090013 178.13826602 172.11323434 179.05912924 C172.11954507 182.04268798 172.11874685 185.02620096 172.11791992 188.00976562 C172.12091334 190.15392109 172.12431629 192.29807601 172.12809753 194.44223022 C172.13692564 200.260822 172.13927522 206.07939907 172.13991332 211.8979969 C172.14062479 215.53797177 172.142761 219.17794292 172.14541054 222.81791687 C172.1546618 235.53063188 172.15874592 248.24333642 172.15795898 260.95605469 C172.15735906 272.78188851 172.16789467 284.6076766 172.18370265 296.43349886 C172.19680997 306.60364384 172.2021415 316.77377393 172.20150357 326.94392729 C172.20124942 333.01020637 172.20405474 339.07644483 172.21468163 345.14271545 C172.22441577 350.85548012 172.22440555 356.56816581 172.21716499 362.28093338 C172.21612556 364.36773927 172.21844356 366.45455022 172.22452545 368.5413475 C172.31603016 402.13770297 164.68833685 429.72327274 141.16015625 454.5078125 C120.76655018 474.10851009 94.91313785 482.5467188 67.0390625 482.59375 C65.63003921 482.60020083 64.22101717 482.60693075 62.81199646 482.61392212 C59.87813211 482.62580135 56.94438469 482.62961245 54.01049805 482.62841797 C50.28783802 482.6282147 46.5659406 482.65556658 42.84346104 482.68996239 C39.93914982 482.71240699 37.03501757 482.71625029 34.13062859 482.71519852 C32.10302416 482.71864139 30.07547555 482.74017567 28.04798889 482.76229858 C12.97413849 482.68878023 0.18035508 478.36639014 -10.83984375 467.9453125 C-14.85213211 463.71404361 -17.56825665 459.51179041 -20.02734375 454.2578125 C-20.38033539 453.5857074 -20.73332703 452.91360229 -21.09701538 452.22113037 C-25.66805336 442.08063746 -24.59224738 430.77587335 -24.56640625 419.8984375 C-24.57632404 417.62163351 -24.58826938 415.34483753 -24.60214233 413.0680542 C-24.63438686 407.09987958 -24.64488657 401.1318884 -24.64898682 395.16363525 C-24.65776997 385.59845766 -24.69330518 376.03342972 -24.74116135 366.46837616 C-24.75371599 363.13643237 -24.75299162 359.80467986 -24.75088501 356.47271729 C-24.75746645 354.42614597 -24.76447294 352.37957597 -24.77197266 350.33300781 C-24.76784866 349.41233017 -24.76372467 348.49165253 -24.75947571 347.54307556 C-24.79571839 338.41639736 -24.79571839 338.41639736 -29.40234375 330.8828125 C-33.81909187 328.14863509 -37.55000689 328.12611135 -42.7043457 328.09667969 C-43.36668213 328.09171478 -44.02901855 328.08674988 -44.71142578 328.08163452 C-46.89616955 328.06706545 -49.08084069 328.0602195 -51.265625 328.0546875 C-52.79013571 328.04893145 -54.31464641 328.04317378 -55.8391571 328.03741455 C-59.034295 328.02691932 -62.22940785 328.02106709 -65.42456055 328.01757812 C-69.50659479 328.01209834 -73.58829466 327.98807534 -77.67022419 327.95960617 C-80.81962533 327.94092599 -83.96894681 327.93577133 -87.11839867 327.93424225 C-88.6226096 327.93122701 -90.12681951 327.92323681 -91.63097572 327.91005707 C-93.74162417 327.89288401 -95.85146707 327.89490361 -97.9621582 327.90136719 C-99.75941093 327.89589874 -99.75941093 327.89589874 -101.5929718 327.89031982 C-106.38204947 328.40277188 -110.51818287 329.6480409 -113.90234375 333.2578125 C-115.65026281 336.36522417 -116.15109068 338.88763107 -116.15332031 342.38696289 C-116.15712708 343.21535172 -116.16093384 344.04374054 -116.16485596 344.89723206 C-116.16588318 345.79095016 -116.1669104 346.68466827 -116.16796875 347.60546875 C-116.18630897 349.50977747 -116.20588039 351.41407465 -116.2265625 353.31835938 C-116.2554185 356.31131298 -116.277341 359.30352954 -116.27783203 362.29663086 C-116.30367393 384.55204225 -116.30367393 384.55204225 -122.02734375 391.2578125 C-127.96396835 396.12056954 -133.34279125 397.770116 -141.02734375 397.2578125 C-148.3459076 395.49078283 -152.86119814 391.50703091 -157.02734375 385.2578125 C-157.99313598 382.36043581 -158.16981969 380.45860296 -158.2043457 377.44189453 C-158.21718094 376.46302277 -158.23001617 375.484151 -158.24324036 374.47561646 C-158.25062729 373.41631927 -158.25801422 372.35702209 -158.265625 371.265625 C-158.27369675 370.16870331 -158.28176849 369.07178162 -158.29008484 367.94161987 C-158.30392889 365.61311421 -158.3146496 363.28458823 -158.32250977 360.95605469 C-158.33960885 357.43123467 -158.38347948 353.90738076 -158.42773438 350.3828125 C-158.56137743 331.03004212 -156.16160687 316.16335156 -142.46875 301.61328125 C-131.50664138 291.03703886 -118.22330677 286.1202569 -103.10107422 286.09667969 C-102.32943436 286.09171478 -101.55779449 286.08674988 -100.76277161 286.08163452 C-98.22334888 286.06709479 -95.68398868 286.0602234 -93.14453125 286.0546875 C-91.83479528 286.05044643 -91.83479528 286.05044643 -90.49860001 286.04611969 C-85.87471467 286.03115751 -81.25086027 286.02191023 -76.62695312 286.01757812 C-71.87961335 286.01210849 -67.13256254 285.98810386 -62.38531303 285.95960617 C-58.70986132 285.94086539 -55.03447751 285.93576807 -51.35898209 285.93424225 C-49.61049959 285.93123921 -47.8620176 285.92329139 -46.11358261 285.91005707 C-27.82837377 285.78156806 -12.12988754 288.73129893 1.73413086 301.66821289 C14.21001812 314.13995327 17.26716647 328.9917466 17.33840275 346.03975105 C17.33729078 348.17614953 17.33176032 350.31254947 17.32221603 352.44892693 C17.3083643 355.84135187 17.31497961 359.23319946 17.32705688 362.62562561 C17.35787662 372.2616069 17.35305942 381.89744731 17.33300781 391.53344727 C17.32210406 397.44777899 17.33524026 403.36167125 17.36290359 409.27594185 C17.36834465 411.52421355 17.36427908 413.77252921 17.35050583 416.0207653 C17.33150033 419.15618059 17.34282754 422.29014754 17.36083984 425.42553711 C17.34750107 426.35183426 17.33416229 427.27813141 17.32041931 428.23249817 C17.37672821 432.63453372 17.55022345 434.66970942 20.18147278 438.33288574 C23.22045534 440.42870599 24.60189464 440.88502436 28.2434082 440.88891602 C29.27250809 440.90144913 30.30160797 440.91398224 31.3618927 440.92689514 C32.46707748 440.91363693 33.57226227 440.90037872 34.7109375 440.88671875 C35.86450241 440.88913071 37.01806732 440.89154266 38.20658875 440.89402771 C40.65183949 440.89304843 43.09711217 440.87963576 45.54223633 440.85473633 C49.23403053 440.82078271 52.92338103 440.83398724 56.61523438 440.85351562 C78.55237242 440.84005065 98.01334809 438.3369601 114.27734375 422.17578125 C125.15721726 410.39713558 130.12333925 396.08878386 130.11982727 380.258255 C130.1253423 378.91463474 130.1253423 378.91463474 130.13096875 377.54387063 C130.14196559 374.54787728 130.14584261 371.55191867 130.1496582 368.5559082 C130.15592581 366.40540966 130.16257288 364.25491219 130.16957092 362.10441589 C130.19057618 355.0474828 130.20096918 347.99054957 130.2109375 340.93359375 C130.21498621 338.50133948 130.21910316 336.06908532 130.22328758 333.63683128 C130.24233051 322.21006743 130.25656413 310.78331001 130.26489955 299.35653335 C130.27467263 286.17763959 130.30099793 272.99891375 130.34140044 259.82007915 C130.37157942 249.62538935 130.38637008 239.43074766 130.38968056 229.23601407 C130.39202873 223.15078504 130.40095944 217.06573559 130.42614174 210.98055458 C130.44945885 205.25380042 130.45364089 199.52734365 130.44338036 193.80055428 C130.4428858 191.70399739 130.4491825 189.60742568 130.4629364 187.51091385 C130.55088896 173.30441898 130.1044248 161.23199776 119.97265625 150.2578125 C114.59898412 144.91737958 108.58356897 140.31642613 102.61254883 135.67211914 C98.07343962 132.14076553 93.60808422 128.52808222 89.16015625 124.8828125 C83.7000222 120.41579075 78.16050088 116.0771205 72.53515625 111.8203125 C65.93287125 106.82128818 59.50881267 101.64147453 53.13916016 96.35009766 C48.22552769 92.27263478 43.2464076 88.29512578 38.21020508 84.37060547 C33.75136514 80.88882753 29.35518347 77.33503265 24.97265625 73.7578125 C17.70940667 67.83305738 10.36121767 62.02511244 2.97265625 56.2578125 C-3.67825788 51.06629895 -10.31178339 45.86072945 -16.84155273 40.51708984 C-20.22532628 37.74971292 -23.62275026 34.99952278 -27.02734375 32.2578125 C-27.74921875 31.67612305 -28.47109375 31.09443359 -29.21484375 30.49511719 C-41.19366591 20.82359493 -41.19366591 20.82359493 -55.02734375 14.2578125 C-56.24421875 13.8246875 -57.46109375 13.3915625 -58.71484375 12.9453125 C-72.25310828 10.09369441 -86.59849025 12.13735583 -98.3203125 19.4375 C-103.75178339 22.98968104 -108.90702369 26.83734749 -114.02734375 30.8203125 C-115.85977327 32.23034201 -117.69312679 33.63917144 -119.52734375 35.046875 C-120.44257813 35.74973633 -121.3578125 36.45259766 -122.30078125 37.17675781 C-159.7258298 65.74150655 -159.7258298 65.74150655 -172.02734375 64.2578125 C-178.24914625 62.42528866 -182.47591125 58.5966436 -186.02734375 53.2578125 C-188.77736216 47.38277316 -188.88466397 41.32214616 -186.96484375 35.1953125 C-183.76164817 27.77125446 -176.77962524 23.09811609 -170.27734375 18.6953125 C-168.77476515 17.65679242 -167.27351371 16.61635011 -165.7734375 15.57421875 C-164.99726074 15.03555176 -164.22108398 14.49688477 -163.42138672 13.94189453 C-159.34400264 11.07367147 -155.3438348 8.10220036 -151.33984375 5.1328125 C-143.62422997 -0.57209383 -135.91060119 -6.2701434 -128.02734375 -11.7421875 C-127.46241211 -12.13776855 -126.89748047 -12.53334961 -126.31542969 -12.94091797 C-83.60663185 -42.59646351 -37.45013273 -30.87663002 0 0 Z " fill="currentColor" transform="translate(327.02734375,29.7421875)"/>
        <path d="M0 0 C4.63605041 3.79898575 6.62562016 7.49420613 7.6875 13.3828125 C7.78236056 19.92819132 6.62386747 25.01897111 2.6875 30.3828125 C0.63545511 32.22882879 -1.27221965 33.80177558 -3.5 35.3828125 C-4.07371338 35.80941162 -4.64742676 36.23601074 -5.23852539 36.67553711 C-7.78783262 38.56960358 -10.36541756 40.42046538 -12.953125 42.26171875 C-21.5701347 48.57792824 -27.03782348 56.88137865 -28.83765793 67.47335148 C-29.35146562 71.70362349 -29.45765666 75.79682042 -29.45294189 80.05137634 C-29.45591302 80.89953071 -29.45888414 81.74768507 -29.4619453 82.62154108 C-29.47058531 85.45074782 -29.47213657 88.279912 -29.47363281 91.10913086 C-29.47826444 93.14329111 -29.48328957 95.1774505 -29.48867798 97.21160889 C-29.5017738 102.73068738 -29.50824185 108.24975372 -29.51268864 113.76884532 C-29.51562492 117.22255728 -29.51973084 120.67626597 -29.52419281 124.12997627 C-29.53786253 134.95179953 -29.54753082 145.77361524 -29.5513947 156.59544653 C-29.55586931 169.05714583 -29.5733917 181.51873511 -29.6023953 193.98040098 C-29.62407219 203.63167 -29.63410224 213.28290821 -29.63543582 222.9342013 C-29.63647987 228.68922414 -29.64230182 234.4441435 -29.66025543 240.19914055 C-29.67683944 245.62056211 -29.67884187 251.04180355 -29.67011642 256.46324158 C-29.66935145 258.44158984 -29.67361654 260.41994821 -29.68357468 262.39827156 C-29.7510225 276.64540894 -29.73118384 291.83486463 -22.75 304.6953125 C-22.40557861 305.35136475 -22.06115723 306.00741699 -21.70629883 306.68334961 C-13.82814757 321.02112902 -0.87936044 330.62181395 14.6875 335.3828125 C22.55453871 337.01806837 30.15179322 337.66852663 38.17236328 337.62231445 C39.78949722 337.62533569 39.78949722 337.62533569 41.43930054 337.62841797 C43.75704824 337.63193659 46.07480559 337.63122996 48.39255142 337.62664223 C52.06771012 337.62100182 55.74255877 337.63028343 59.41769409 337.6438446 C69.85871893 337.68078562 80.29963411 337.6994992 90.74072266 337.68823242 C97.1478607 337.68236918 103.55455711 337.70069314 109.96160507 337.73412132 C112.39273723 337.74204966 114.82391784 337.74083344 117.25503922 337.73009682 C120.65765475 337.71570763 124.05888591 337.73210385 127.46142578 337.75512695 C128.4539032 337.74335922 129.44638062 337.73159149 130.46893311 337.71946716 C137.44052118 337.81153021 142.88541154 339.42854173 148.6875 343.3828125 C153.93664015 348.87644993 155.05795946 354.17698579 154.9609375 361.53125 C154.36915773 367.70266758 151.68104504 371.74689935 147.125 375.8203125 C143.44370365 378.82930083 140.4463666 379.50734287 135.74034119 379.52998352 C134.20814186 379.54071648 134.20814186 379.54071648 132.64498901 379.55166626 C130.9643486 379.55569962 130.9643486 379.55569962 129.24975586 379.55981445 C128.0687883 379.56638565 126.88782074 379.57295685 125.67106628 379.57972717 C121.74816536 379.59949198 117.82527788 379.61114236 113.90234375 379.62109375 C112.54595991 379.62514397 111.18957626 379.62926097 109.83319283 379.63344383 C103.44729549 379.65251011 97.06140969 379.66672754 90.67548937 379.6750558 C83.34434609 379.68477736 76.01350885 379.71095603 68.68247312 379.75155669 C62.99470257 379.78195464 57.30701839 379.79654757 51.61916834 379.79983681 C48.23372057 379.80216426 44.84859901 379.81081432 41.46323967 379.83629799 C19.98890181 379.97561317 2.0145266 378.10690383 -17.3125 368.3828125 C-18.37082031 367.85945313 -19.42914063 367.33609375 -20.51953125 366.796875 C-28.4116615 362.55601864 -34.60026916 356.94404967 -40.94238281 350.71337891 C-42.04656462 349.6410712 -43.1861559 348.60529248 -44.3359375 347.58203125 C-60.59630122 332.81029238 -69.32676722 308.75902867 -71.3125 287.3828125 C-71.44672485 284.28564961 -71.4561769 281.19349083 -71.45294189 278.09373474 C-71.45591302 277.19093421 -71.45888414 276.28813367 -71.4619453 275.35797554 C-71.47057762 272.34988755 -71.4721359 269.34183961 -71.47363281 266.33374023 C-71.4782649 264.16973283 -71.48329008 262.00572624 -71.48867798 259.84172058 C-71.50176724 253.97360601 -71.50824027 248.10550286 -71.51268864 242.23737597 C-71.51562527 238.56607139 -71.51973121 234.8947699 -71.52419281 231.22346687 C-71.53785924 219.7219486 -71.5475298 208.22043742 -71.5513947 196.71891159 C-71.55587202 183.46992811 -71.57340847 170.22104797 -71.6023953 156.97209591 C-71.62405726 146.71275958 -71.63410141 136.45345223 -71.63543582 126.19409329 C-71.6364807 120.07526708 -71.64232088 113.95653813 -71.66025543 107.83773613 C-71.67681405 102.07650641 -71.67885395 96.31544626 -71.67011642 90.55420113 C-71.66935018 88.4496528 -71.67363373 86.34509506 -71.68357468 84.24057007 C-71.79780541 58.53252523 -66.6335207 35.80617355 -47.98046875 16.7734375 C-35.56391205 4.83836064 -17.24980996 -12.17224493 0 0 Z " fill="currentColor" transform="translate(84.3125,132.6171875)"/>
        </svg>
        <span>–î–æ–º–æ–π</span>
      </div>
      <div class="footer-item" id="catalog-button" data-section="catalog">
        <img src="/static/category.svg" alt="–ö–∞—Ç–∞–ª–æ–≥">
        <span>–ö–∞—Ç–∞–ª–æ–≥</span>
      </div>
      <div class="footer-item" id="cart-footer-button" data-section="cart">
        <img src="/static/add-cart.svg" alt="–ö–æ—Ä–∑–∏–Ω–∞">
        <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
        <span id="cart-badge" class="cart-badge"></span>
      </div>
      <div class="footer-item" id="promotions-button" data-section="promotions">
        <img src="/static/discount.svg" alt="–ê–∫—Ü–∏–∏">
        <span>–ê–∫—Ü–∏–∏</span>
      </div>
      <div class="footer-item" id="login-button" data-section="user">
        <img src="/static/log-in.svg" alt="–ö–∞–±–∏–Ω–µ—Ç">
        <span>–ö–∞–±–∏–Ω–µ—Ç</span>
      </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
                if (typeof initFooter === 'function') {
                    initFooter();
                }
                function openCart() {
                    toggleCart(); // —Ç–µ–ø–µ—Ä—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤—ã–µ–∑–∂–∞—é—â—É—é –ø–∞–Ω–µ–ª—å
                }
                function copyPhoneNumber() {
                    const phone = "+375 29 225-13-34";
                    
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    const fallbackCopy = () => {
                        const textarea = document.createElement('textarea');
                        textarea.value = phone;
                        textarea.style.position = 'fixed';
                        document.body.appendChild(textarea);
                        textarea.select();
                        
                        try {
                            const success = document.execCommand('copy');
                            showToast(success ? "–ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!" : "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å");
                        } catch (err) {
                            showToast("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏");
                        } finally {
                            document.body.removeChild(textarea);
                        }
                    };
                
                    // –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±
                    if (navigator.clipboard) {
                        navigator.clipboard.writeText(phone)
                            .then(() => {
                                showToast("–ù–æ–º–µ—Ä —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!");
                                try {
                                    if (navigator.vibrate) navigator.vibrate(50);
                                } catch (e) {
                                    console.log("–í–∏–±—Ä–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞");
                                }
                            })
                            .catch((err) => {
                                console.error("Clipboard error:", err);
                                fallbackCopy(); // –ü—Ä–æ–±—É–µ–º —Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±
                            });
                    } else {
                        fallbackCopy();
                    }
                }
                // ===== –ù–ê–ß–ê–õ–û –í–°–¢–ê–í–ö–ò =====
                // –§–æ–Ω–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                if (window.Telegram?.WebApp?.initDataUnsafe?.user) {
                    const tgUser = Telegram.WebApp.initDataUnsafe.user;
                    const userKey = `user_${tgUser.id}`;
        
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –æ–±–Ω–æ–≤–ª—è–ª–∏ –¥–∞–Ω–Ω—ã–µ
                    const lastUpdate = localStorage.getItem(`${userKey}_last_update`);
                    const now = Date.now();
        
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –æ–Ω–∏ —Å—Ç–∞—Ä—ã–µ (—Å—Ç–∞—Ä—à–µ 5 –º–∏–Ω—É—Ç)
                    if (!lastUpdate || (now - parseInt(lastUpdate)) > 300000) {
                        (async () => {
                            try {
                                const response = await fetch(`/api/get-user?username=${encodeURIComponent(tgUser.username || `id${tgUser.id}`)}`);
                                const result = await response.json();
                    
                                const userData = {
                                    id: tgUser.id,
                                    username: tgUser.username || `id${tgUser.id}`,
                                    first_name: result.exists ? result.user.Name : tgUser.first_name || '',
                                    phone: result.exists ? result.user.Phone : tgUser.phone_number || '',
                                    photo_url: tgUser.photo_url || '/static/user-avatar.png',
                                    updated_at: now
                                };
                    
                                localStorage.setItem(userKey, JSON.stringify(userData));
                                localStorage.setItem(`${userKey}_last_update`, now.toString());
                    
                                if (!result.exists) {
                                    await fetch('/api/save-user', {
                                        method: 'POST',
                                        headers: {'Content-Type': 'application/json'},
                                        body: JSON.stringify({
                                            username: userData.username,
                                            name: userData.first_name,
                                            phone: userData.phone
                                        })
                                    });
                                }
                            } catch (error) {
                                console.error('–§–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å:', error);
                            }
                        })();
                    }
                }
                // ===== –ö–û–ù–ï–¶ –í–°–¢–ê–í–ö–ò =====
            const setFullHeight = () => {
                document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
            };
            window.addEventListener('resize', setFullHeight);
            window.addEventListener('load', setFullHeight);
            setFullHeight();

            document.body.style.overflow = 'hidden';
            document.body.style.userSelect = 'none';
            document.addEventListener('dblclick', (e) => e.preventDefault());
            document.getElementById('back-button').addEventListener('click', goBack);
            document.getElementById('login-button').addEventListener('click', function() {
                if (window.Telegram?.WebApp?.initDataUnsafe?.user) {
                    showUserPage(); // ‚úÖ –ó–∞–º–µ–Ω–∏–ª–∏ –≤–µ—Å—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤—ã–∑–æ–≤
                } else {
                    Telegram.WebApp.openTelegramLink('https://t.me/Shop_NEKURIBY_bot?start=login');
                }
            });
            document.getElementById('home-button').addEventListener('click', function() {
                console.log('Home button clicked');
                goHome();
            });
            if (window.Telegram?.WebApp) {
                Telegram.WebApp.expand();
                Telegram.WebApp.ready();
            } else {
                document.body.innerHTML = "–û—à–∏–±–∫–∞: –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram!";
                return;
            }
        });
        let currentState = "home";
        let currentRegion = null;
        let currentCity = null;
        showHome();
        const contentDiv = document.getElementById('content');

        contentDiv.addEventListener('click', (e) => {
            if (e.target.closest('#back-button')) {
                goBack();
                return;
            }
            const promoItem = e.target.closest('[data-action="showPromoDetail"]');
            if (promoItem) {
                const promoData = JSON.parse(promoItem.dataset.promo);
                showPromotionDetail(promoData);
                return;
            }
            const btn = e.target.closest('button');
            if (!btn) return;

            const action = btn.dataset.action;
            if (action) {
                console.log("–ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞:", action);
    
                if (action === 'regions') showRegions();
                else if (action.startsWith('section:')) showSection(action.split(':')[1]);
                else if (action.startsWith('city:')) showCities(action.split(':')[1]);
                else if (action.startsWith('store:')) {
                    const [_, city, region] = action.split(':');
                    showStores(city, region);
                } else if (action.startsWith('detail:')) {
                    showStoreDetails(action.split(':')[1]);
                } else if (action === 'goHome') {
                    goHome();
                }
            }

            const starEl = e.target.closest('.star');
            if (starEl && starEl.dataset.stars) {
                const count = parseInt(starEl.dataset.stars);
                selectStars(count);
            }


            const submitBtn = e.target.closest('#submit-review');
            if (submitBtn) {
                submitReview();
            }
        });

        async function loadData(url) {
            try {
                const response = await fetch(`/api/${url}`);
                if (!response.ok) throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö");
                return await response.json();
            } catch (error) {
                console.error(error);
                return null;
            }
        }

        function showToast(message, duration = 2000) {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0,0,0,0.7);
                color: white;
                padding: 12px 24px;
                border-radius: 4px;
                z-index: 1000;
                opacity: 0;
                transition: opacity 0.3s;
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.style.opacity = 1, 10);
            setTimeout(() => {
                toast.style.opacity = 0;
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }
        function showContent(content, showBack = true, onRendered = null) {
            const contentDiv = document.getElementById('content');
            const backButton = document.getElementById('back-button');
            const carousels = document.querySelectorAll('.promotions-carousel');
            carousels.forEach(carousel => {
                const intervalId = carousel.dataset.intervalId;
                if (intervalId) clearInterval(intervalId);
            });
            if (backButton) {
                backButton.style.display = showBack ? 'block' : 'none';
            } else {
                console.warn('‚ö†Ô∏è #back-button –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ DOM');
            }

            contentDiv.classList.add('hidden');
            setTimeout(() => {
                contentDiv.innerHTML = content;
                setTimeout(() => {
                    contentDiv.classList.remove('hidden');
                    if (typeof onRendered === 'function') onRendered();
                }, 50);
            }, 300);
        }



        function showHome() {
            currentState = "home";
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–∫—Ü–∏–∏ –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏
            loadPromotionsForCarousel().then(carouselHTML => {
                showContent(`
                    <button data-action="regions">–ê–¥—Ä–µ—Å–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤</button>
                    <button data-action="section:review">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                    <button data-action="section:contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
                    <button data-action="section:jobs">–í–∞–∫–∞–Ω—Å–∏–∏</button>
                    
                    ${carouselHTML}
                `, false, () => {
                    initCarousel();
                    document.getElementById('content').scrollTo(0, 0);
                });
            });
        }
        async function loadPromotionsForCarousel() {
            try {
                // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–µ–∂–∏–µ –∞–∫—Ü–∏–∏
                const response = await fetch('https://nekuri.by/api/news-feed.php');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const promotions = await response.json();
                
                // –ï—Å–ª–∏ –Ω–µ—Ç —Å–≤–µ–∂–∏—Ö, –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∫—ç—à–∞
                if (!Array.isArray(promotions) || promotions.length === 0) {
                    const cached = localStorage.getItem('cachedPromotions');
                    if (cached) return createCarouselHTML(JSON.parse(cached).slice(0, 5));
                    return ''; // –ï—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç –∞–∫—Ü–∏–π, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º HTML
                localStorage.setItem('cachedPromotions', JSON.stringify(promotions));
                localStorage.setItem('promotionsCacheTime', Date.now().toString());
                return createCarouselHTML(promotions.slice(0, 5));
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ü–∏–π –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏:", error);
                const cached = localStorage.getItem('cachedPromotions');
                if (cached) return createCarouselHTML(JSON.parse(cached).slice(0, 5));
                return ''; // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –∏ –Ω–µ—Ç –∫—ç—à–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
            }
        }
        
        function createCarouselHTML(promotions) {
            if (!promotions || promotions.length === 0) return '';
            
            const slides = promotions.map(promo => `
                <div class="carousel-slide">
                    <div class="carousel-banner" data-promo='${JSON.stringify(promo).replace(/'/g, "\\'")}'>
                        <img src="${promo.image}" alt="${promo.title}" 
                             style="width: 100%; height: 100%; object-fit: contain;"
                             onerror="this.onerror=null;this.src='/static/no-image.png'">
                    </div>
                </div>
            `).join('');
            
            const indicators = promotions.map((_, index) => `
                <div class="carousel-indicator ${index === 0 ? 'active' : ''}" data-index="${index}"></div>
            `).join('');
            
            return `
                <div class="promotions-carousel">
                    <div class="carousel-container">
                        ${slides}
                    </div>
                    <div class="carousel-indicators">
                        ${indicators}
                    </div>
                </div>
            `;
        }
        
        function initCarousel() {
            const carousel = document.querySelector('.promotions-carousel');
            if (!carousel) return;
            
            const container = carousel.querySelector('.carousel-container');
            const slides = carousel.querySelectorAll('.carousel-slide');
            const indicators = carousel.querySelectorAll('.carousel-indicator');
            const banners = carousel.querySelectorAll('.carousel-banner');
            
            let currentIndex = 0;
            let intervalId;
            let isDragging = false;
            let startPos = 0;
            let currentTranslate = 0;
            let prevTranslate = 0;
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ —Å–≤–∞–π–ø–µ
            function preventHorizontalScroll(e) {
                if (isDragging) {
                    e.preventDefault();
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞
            container.addEventListener('touchmove', preventHorizontalScroll, { passive: false });
            
            // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞
            function startAutoSlide() {
                intervalId = setInterval(() => {
                    goToSlide((currentIndex + 1) % slides.length);
                }, 3000);
            }
            
            function goToSlide(index) {
                currentIndex = index;
                updateCarousel();
            }
            
            function updateCarousel() {
                container.style.transform = `translateX(-${currentIndex * 100}%)`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
                indicators.forEach((indicator, i) => {
                    indicator.classList.toggle('active', i === currentIndex);
                });
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–≤–∞–π–ø–∞
            container.addEventListener('touchstart', (e) => {
                isDragging = true;
                startPos = e.touches[0].clientX;
                clearInterval(intervalId);
            });
            
            container.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                const currentPosition = e.touches[0].clientX;
                const diff = currentPosition - startPos;
                container.style.transform = `translateX(calc(-${currentIndex * 100}% + ${diff}px)`;
            });
            
            container.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                isDragging = false;
                
                const endPos = e.changedTouches[0].clientX;
                const diff = endPos - startPos;
                
                if (diff > 50 && currentIndex > 0) {
                    goToSlide(currentIndex - 1);
                } else if (diff < -50 && currentIndex < slides.length - 1) {
                    goToSlide(currentIndex + 1);
                } else {
                    goToSlide(currentIndex);
                }
                
                startAutoSlide();
            });
            
            // –ö–ª–∏–∫ –ø–æ –±–∞–Ω–Ω–µ—Ä—É
            banners.forEach(banner => {
                banner.addEventListener('click', () => {
                    const promoData = JSON.parse(banner.dataset.promo);
                    showPromotionDetail(promoData);
                });
            });
            
            // –ö–ª–∏–∫ –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—É
            indicators.forEach(indicator => {
                indicator.addEventListener('click', () => {
                    const index = parseInt(indicator.dataset.index);
                    goToSlide(index);
                    clearInterval(intervalId);
                    startAutoSlide();
                });
            });
            
            startAutoSlide();
        }
        function goBack() {
          console.log("üîô goBack –≤—ã–∑–≤–∞–Ω. currentState =", currentState);
          if (currentState === "promotionDetail") {
            showPromotions();
          } else if (currentState === "regions") {
            showHome();
          } else if (currentState === "cities") {
            showRegions();
          } else if (currentState === "stores") {
            showCities(currentRegion);
          } else if (currentState === "storeDetails") {
            showStores(currentCity, currentRegion);
          } else if (currentState === "user") {
              setActiveFooter('user');
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
            if (document.getElementById('order-detail-screen')?.style.display === 'block') {
              goBackToOrders();
            } else if (document.getElementById('orders-screen')?.style.display === 'block') {
              goBackToProfile();
            } else if (document.getElementById('edit-form')?.style.display === 'block') {
              cancelEdit();
            } else {
              showHome();
              setActiveFooter('home');
            }
          } else if (["review", "contacts", "jobs", "promotions"].includes(currentState)) {
            showHome();
            setActiveFooter('home');
          } else {
            console.warn("‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:", currentState);
            showHome();
            setActiveFooter('home');
          }
        }
        async function showRegions() {
            currentState = "regions";
            const regions = await loadData('regions');
            if (regions) {
                const buttons = regions.map(region =>
                    `<button data-action="city:${region}">${region}</button>`).join('');
                showContent(`<h3>–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å:</h3>${buttons}`, true);
            }
        }

        async function showCities(region) {
            currentState = "cities";
            currentRegion = region;
            const cities = await loadData(`cities/${region}`);
            if (cities) {
                const buttons = cities.map(city =>
                    `<button data-action="store:${city}:${region}">${city}</button>`).join('');
                showContent(`<h3>–ì–æ—Ä–æ–¥–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ "${region}":</h3>${buttons}`, true);
            }
        }

        async function showStores(city, region) {
            currentState = "stores";
            currentCity = city;
            const stores = await loadData(`stores/${region}/${city}`);
            if (stores) {
                const buttons = stores.map(store =>
                    `<button data-action="detail:${store.name}">${store.name}</button>`).join('');
                showContent(`<h3>–ú–∞–≥–∞–∑–∏–Ω—ã –≤ –≥–æ—Ä–æ–¥–µ "${city}":</h3>${buttons}`, true);
            }
        }

        async function showStoreDetails(storeName) {
            currentState = "storeDetails";
            const stores = await loadData(`stores/${currentRegion}/${currentCity}`);
            const store = stores.find(s => s.name === storeName);
            if (store) {
                showContent(`
                    <h3>${store.name}</h3>
                    <p><strong>–ê–¥—Ä–µ—Å:</strong> ${store.address}</p>
                    <p><strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> ${store.hours.replace(/\n/g, '<br>')}</p>
                    <button class="secondary" onclick='window.open("${store.map_url}", "_blank")'>–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
                `, true);
            }
        }

        function showSection(section) {
            if (section === 'contacts') {
                currentState = "contacts";
                showContent(`
                    <h3>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏</h3>
                    <button id="copy-phone-btn">–ü–æ–∑–≤–æ–Ω–∏—Ç—å: +375 29 225-13-34</button>
                    <button onclick="window.open('https://www.instagram.com/nekuri.by/', '_blank')">Instagram</button>
                    <button onclick="window.open('https://t.me/nekuri_by', '_blank')">Telegram –∫–∞–Ω–∞–ª</button>
                    <button onclick="window.open('https://t.me/nekuri_by_brest', '_blank')">Telegram —á–∞—Ç</button>
                    <button onclick="window.open('https://vk.com/nekuribrest', '_blank')">–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</button>
                    <button onclick="window.open('https://www.tiktok.com/@nekuri.by', '_blank')">TikTok</button>
                `, true, () => {
                    document.getElementById('copy-phone-btn').addEventListener('click', function() {
                        console.log("–ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∞");
                        copyPhoneNumber();
                    });
                });
            } else if (section === 'review') {
                checkReviewCooldown();
            } else if (section === 'jobs') {
                currentState = "jobs";
                showContent(`
                    <div class="vacancy-block">
                        <h3>–ü—Ä–æ–¥–∞–≤–µ—Ü-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</h3>
                        <p>–≠—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏—è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤–ª—é–±–ª–µ–Ω –≤ –Ω–∞—à –ø—Ä–æ–¥—É–∫—Ç, –∫—Ç–æ –ª—é–±–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –∏ —Ö–æ—á–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–º –±–∏–∑–Ω–µ—Å–µ.</p>
                        <h4>–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:</h4>
                        <ul>
                            <li>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã (–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ).</li>
                            <li>–ó–∞–¥–∞–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ª—É—á—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –≤ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Å–µ—Ç–∏.</li>
                            <li>–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞, –∫–æ–º–ø–ª–µ–∫—Ç–Ω–æ—Å—Ç–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏, –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞).</li>
                            <li>–†–∞—Å—á–µ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –Ω–∞ –∫–∞—Å—Å–µ.</li>
                            <li>–í—ã–∫–ª–∞–¥–∫–∞ —Ç–æ–≤–∞—Ä–∞, —Ü–µ–Ω–Ω–∏–∫–∏, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞.</li>
                            <li>–£—á–∞—Å—Ç–∏–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è—Ö.</li>
                            <li>–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —á–∏—Å—Ç–æ—Ç—ã –∏ –ø–æ—Ä—è–¥–∫–∞ –≤ —Ç–æ—Ä–≥–æ–≤–æ–º –∑–∞–ª–µ.</li>
                            <li>–°–æ–±–ª—é–¥–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤.</li>
                        </ul>
                        <h4>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</h4>
                        <ul>
                            <li>–ì—Ä–∞–º–æ—Ç–Ω–∞—è —Ä–µ—á—å, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.</li>
                            <li>–ö–∞–∫ –ø–ª—é—Å ‚Äî –∑–Ω–∞–Ω–∏–µ –∫–∞—Å—Å–æ–≤–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, —É–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–µ–Ω–µ–∂–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏.</li>
                            <li>–£–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ, –∂–µ–ª–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å, –∫–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–∞–ª–∏—á–∏–µ –ª–∏–¥–µ—Ä—Å–∫–∏—Ö –∫–∞—á–µ—Å—Ç–≤.</li>
                        </ul>
                        <p>–ú—ã —Ä–∞–¥—ã –ø—Ä–∏–Ω—è—Ç—å –≤ –Ω–∞—à –¥—Ä—É–∂–Ω—ã–π, –º–æ–ª–æ–¥–æ–π –∫–æ–ª–ª–µ–∫—Ç–∏–≤ –∫–æ–ª–ª–µ–≥, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –≤–ø–µ—Ä–µ–¥!</p>
                        <h4>–£—Å–ª–æ–≤–∏—è —Ä–∞–±–æ—Ç—ã:</h4>
                        <ul>
                            <li>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ.</li>
                            <li>–†–∞–±–æ—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–º –∫–æ–ª–ª–µ–∫—Ç–∏–≤–µ.</li>
                            <li>–û–ø–ª–∞—Ç–∞ —Ç—Ä—É–¥–∞, –∑–∞–≤–∏—Å—è—â–∞—è –æ—Ç –í–∞—à–µ–π —Ä–∞–±–æ—Ç—ã.</li>
                        </ul>
                        <p>–ï—Å–ª–∏ –≤—Å—ë –∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ –≤—ã—à–µ –í–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —Ç–æ –º—ã –∂–¥—ë–º –í–∞—à–∏—Ö –æ—Ç–∫–ª–∏–∫–æ–≤!</p>
                        <h3 style="margin-top: 20px;">–ê–Ω–∫–µ—Ç–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</h3>
                        <p>–ü–æ—Å–ª–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è —Ä–µ–∑—é–º–µ —Å –í–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø–æ–¥–±–æ—Ä—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞.</p>
                        <div class="form-container">
                            <iframe src="https://forms.yandex.ru/u/68079eb7d046880cc459b018/?iframe=1"
                                frameborder="0"
                                name="ya-form-68079eb7d046880cc459b018"
                                width="100%"
                                height="480" style="border: none;"></iframe>
                        </div>

                    </div>
                `, true);
            } else if (section === 'catalog') {
                // –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
                document.getElementById('content').classList.add('fade-out');
                setTimeout(() => {
                    window.location.href = '/catalog';
                }, 300);
            } else if (section === 'promotions') {
                currentState = "promotions";
                showPromotions();
            } else {
                alert(`–†–∞–∑–¥–µ–ª "${section}" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!`);
            }
        }


        function checkReviewCooldown() {
            const lastTime = localStorage.getItem('lastReviewTime');
            if (lastTime) {
                const now = Date.now();
                const diff = now - parseInt(lastTime);
                const remaining = 24 * 60 * 60 * 1000 - diff;
                if (remaining > 0) {
                    const hours = Math.floor(remaining / (60 * 60 * 1000));
                    const minutes = Math.floor((remaining % (60 * 60 * 1000)) / (60 * 1000));
                    showContent(`
                        <p>‚ö†Ô∏è –í—ã —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –æ—Ç–∑—ã–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞.</p>
                        <p>‚åõÔ∏è –î–æ —Å–ª–µ–¥—É—é—â–µ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –æ—Å—Ç–∞–ª–æ—Å—å:<br><strong>${hours} —á ${minutes} –º–∏–Ω</strong>.</p>
                    `, true);
                    return;
                }
            }
            showReviewForm();
        }

        function showReviewForm() {
            currentState = "review";

            showContent(`
                <h3>–û—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</h3>
                <div id="stars" style="font-size: 32px; margin-bottom: 10px;">
                    ${[1, 2, 3, 4, 5].map(i => `
                        <span class="star" data-stars="${i}" id="star${i}">‚≠ê</span>
                    `).join('')}
                </div>
                <textarea id="reviewText" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–∑—ã–≤..." rows="5"
                          style="width: 90%; margin-top: 20px; border-radius: 10px; padding: 10px; border: 1px solid #ccc;"></textarea>
                <button id="submit-review">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                <div id="toast" class="toast"></div>
            `, true, () => {
                // ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–≤—ë–∑–¥
                const stars = document.querySelectorAll('.star');
                stars.forEach(star => {
                    star.addEventListener('click', () => {
                        const count = parseInt(star.dataset.stars);
                        window.reviewStars = count;

                        stars.forEach((el, index) => {
                            if (index < count) {
                                el.textContent = 'üåü';
                                el.classList.add('pop');
                            } else {
                                el.textContent = '‚≠ê';
                                el.classList.remove('pop');
                            }
                        });
                    });
                });

                // ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
                const submitBtn = document.getElementById('submit-review');
                submitBtn.addEventListener('click', () => {
                    const text = document.getElementById('reviewText').value.trim();

                    if (!window.reviewStars || window.reviewStars === 0) {
                        showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ—Ü–µ–Ω–∫—É");
                        return;
                    }

                    if (text.length < 3) {
                        showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤");
                        return;
                    }

                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
                    sendReviewToTelegram(window.reviewStars, text);
                    localStorage.setItem('lastReviewTime', Date.now().toString());

                    showContent(`
                        <p>üôè –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –æ—Ç–∑—ã–≤!</p>
                        <p>–ù–∞–º –≤–∞–∂–Ω–æ –≤–∞—à–µ –º–Ω–µ–Ω–∏–µ üòä</p>
                        <button data-action="goHome">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                    `, true);
                });

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                window.reviewStars = 0;
            });
        }





        function selectStars(count) {
            window.reviewStars = count;
            for (let i = 1; i <= 5; i++) {
                const el = document.getElementById(`star${i}`);
                if (i <= count) {
                    el.textContent = 'üåü';
                    el.classList.add('pop');
                } else {
                    el.textContent = '‚≠ê';
                    el.classList.remove('pop');
                }
            }
        }

        function sendReviewToTelegram(stars, text) {
            const username = Telegram.WebApp.initDataUnsafe?.user?.username || '–ë–µ–∑ username';
            const message = `‚≠ê –û—Ü–µ–Ω–∫–∞: ${stars}/5\n‚úçÔ∏è –û—Ç–∑—ã–≤: ${text}\nüë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @${username}`;
            fetch('https://api.telegram.org/bot7210822073:AAFM7PAj5D9PEJrvwArF8rSaU4FqsyT-3ns/sendMessage', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: '568416622',
                    text: message
                })
            });
        }

        async function showPromotions() {
            currentState = "promotions"; // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            showContent(`<p>–ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ü–∏–π...</p>`, true);
            
            try {
                const response = await fetch('https://nekuri.by/api/news-feed.php');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const promotions = await response.json();
                if (!Array.isArray(promotions)) throw new Error("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö");
                
                localStorage.setItem('cachedPromotions', JSON.stringify(promotions));
                localStorage.setItem('promotionsCacheTime', Date.now().toString());
                
                renderPromotions(promotions);
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ü–∏–π:", error);
                const cached = localStorage.getItem('cachedPromotions');
                if (cached) {
                    renderPromotions(JSON.parse(cached));
                    showToast("–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ");
                } else {
                    showContent(`
                        <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–∫—Ü–∏–∏</p>
                        <button onclick="showPromotions()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                        <button data-action="goHome">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                    `, true);
                }
            }
        }
        let promotionsScrollPosition = 0;
        function renderPromotions(promotions) {
            if (!promotions || !Array.isArray(promotions)) {
                showContent(`<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∞–∫—Ü–∏—è—Ö</p><button data-action="goHome">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>`, true);
                return;
            }
        
            const promotionsHTML = promotions.map(promo => `
                <div class="promotion-item" data-action="showPromoDetail" data-promo='${JSON.stringify(promo).replace(/'/g, "\\'")}'>
                    <img src="${promo.image}" alt="${promo.title}" 
                         onerror="this.onerror=null;this.src='/static/no-image.png'">
                    <h4>${promo.title}</h4>
                    ${promo.description ? `<p>${promo.description.substring(0, 100)}...</p>` : ''}
                </div>
            `).join('');
        
            showContent(`
                <h3>–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∞–∫—Ü–∏–∏</h3>
                ${promotionsHTML.length ? promotionsHTML : '<p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π</p>'}
                <button data-action="goHome" style="margin-top: 20px;">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
            `, true);
            setTimeout(() => {
                window.scrollTo(0, promotionsScrollPosition);
            }, 50);
        }
        function showPromotionDetail(promoData) {
            currentState = "promotionDetail";
            
            promotionsScrollPosition = window.scrollY;
            window.scrollTo(0, 0);
            
            let processedContent = promoData.full_content || promoData.description || '–ù–µ—Ç —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è';
            processedContent = processedContent.replace(/<a\b[^>]*>(.*?)<\/a>/gi, '$1');
            processedContent = processedContent.replace(/<(?!\/?(p|br|img|h3|h4|ul|li|strong|em)(?=>|\s.*>))\/?.*?>/gi, '');
            processedContent = processedContent.replace(/<img([^>]+)src="([^"]+)"/gi, 
                (match, attrs, src) => `<img${attrs}src="${src}" style="max-width:100%; height:auto; border-radius:8px; margin:10px 0;"`);
        
            showContent(`
                <div class="promotion-detail">
                    <img src="${promoData.image}" alt="${promoData.title}" 
                         style="width:100%; border-radius:12px; margin-bottom:15px;"
                         onerror="this.onerror=null;this.src='/static/no-image.png'">
                    
                    <h3 style="margin-bottom:15px; color:#333;">${promoData.title}</h3>
                    
                    <div class="news-content" style="white-space:pre-line; line-height:1.5; font-size:16px; color:#444; margin-bottom:20px;">
                        ${processedContent}
                    </div>
                    
                    <button onclick="window.open('${promoData.link}', '_blank')" 
                            style="margin-top:20px; padding:12px 24px; background:#ff0000; color:white; border:none; border-radius:25px; font-size:16px; cursor:pointer; width:100%;">
                        –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–∞–π—Ç–µ
                    </button>
                </div>
            `, true);
        }
        function goHome() {
            document.getElementById('content').classList.add('fade-out');
            setTimeout(() => {
                showHome();
                document.getElementById('content').scrollTo(0, 0);
            }, 300);
        }

        
        
        
        function updateUserData(user) {
            document.getElementById('user-name').textContent = user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            document.getElementById('user-phone').textContent = user.phone || '–ù–µ —É–∫–∞–∑–∞–Ω';
        }
        function showUserPage() {
          currentState = 'user';
          // –ó–∞–≥—Ä—É–∂–∞–µ–º CSS —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
          if (!document.getElementById('user-css')) {
            const link = document.createElement('link');
            link.id = 'user-css';
            link.rel = 'stylesheet';
            link.href = '/static/css/user.css';
            document.head.appendChild(link);
          }

          fetch('/static/html/user.html')
            .then(res => res.text())
            .then(html => {
              showContent(html, false, () => {
                if (typeof initUserPage === 'function') {
                  initUserPage();
                } else {
                  showToast('–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç');
                }
              });
            })
            .catch(err => {
              console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ user.html:', err);
              showToast('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç');
            });
        }
        
        window.showUserPage = showUserPage;

        // –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.showHome = showHome;
        window.goHome = goHome;
        window.auth = auth; // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
        window.openCart = openCart;
        window.goBack = goBack;
        window.showSection = showSection;
        window.copyPhoneNumber = copyPhoneNumber;

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤
        window.showRegions = showRegions;
        window.showCities = showCities;
        window.showStores = showStores;
        window.showStoreDetails = showStoreDetails;
        
    </script>
    <script src="/static/js/footer.js"></script>
    <script src="/static/js/user.js"></script>
</body>
</html>
